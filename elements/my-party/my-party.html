<link rel="import"  href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import"  href="../../bower_components/iron-image/iron-image.html">
<link rel="import"  href="../../bower_components/iron-selector/iron-selector.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<dom-module id="my-party">
    <style>
      :host {
        display: block;
        margin:15px 15px;
      }

      paper-item{
        margin-bottom: 15px;
        @apply(--layout-horizontal);
      }
      paper-item span{
        margin-left: 15px;
        @apply(--layout-flex-8);
      }
      .image-wrapper{
        @apply(--layout-flex-4);
      }
      iron-image{
        width: 80px;
        height: 80px;
        background-color: #FFF;
        border-radius: 50%;
        overflow: hidden;
        border:1px solid #CCC;
        
      }
      
      .iron-selected {
        background: #F0F0F0;
      }
    </style>
  <template>
      <iron-ajax
        auto
        url="/party"
        handle-as="json"
        on-response="loadParty"></iron-ajax>
        
        <div class="list short">
        <iron-selector id="party" selected="{{selected}}">
          <template is="dom-repeat" items="{{parties}}" as="party" index-as="index">
            <paper-item>
              <div class="image-wrapper">
                <iron-image sizing="contain" src="[[party.PartySeal]]"></iron-image>
              </div>
              <span>[[party.PartyName]]</span>
            </paper-item>
          </template>
        </iron-selector>
        </div>
  </template>

</dom-module>
  <script>
    (function () {
      Polymer({
        is: 'my-party',
        properties: {
          parties: Array,
          selected:{
            type: Number,
            observer: '_partySelected'
          }
        },
        generateRoute:function(index){
            return 'party/'+index;
        },
        loadParty:function(req){
            this.parties=req.detail.response;
        },
        _partySelected:function(newIndex, oldIndex){
            var page=document.querySelector('neon-animated-pages');
              app.party=this.parties[newIndex];
              page.selected = 1;
              var party=document.querySelector('party-detail');
              party.PartySeal=app.party.PartySeal;
              party.PartyFlag=app.party.PartyFlag;
              party.PartyName=app.party.PartyName;
              party.PartyNameEnglish=app.party.PartyNameEnglish;
              party.Chairman=app.party.Chairman;
              party.Leadership=app.party.Leadership;
              party.Region=app.party.Region;
              party.Headquarters=app.party.Headquarters;

        }
      });
    })();
  </script>